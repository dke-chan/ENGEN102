---
title: "Inference for a Difference in Means"
author: "ENGEN102-23G (HAM) - Engineering Maths and Modelling 1B"
format:
  revealjs: 
    slide-number: c/t
    progress: true
    auto-stretch: false
    height: 1080
    width: 1920
    theme: reveal-extra/quartz.scss
    template-partials:
      - reveal-extra/title-block.html
    highlight-style: breeze
    code-line-numbers: false
    embed-resources: false
editor: source
---
  
```{r setup}
#| include: false
library(knitr)
library(ggplot2)
```

## Motivation

## Sampling Distribution of the Difference in Sample Means



## Standard Error of *x&#772;*~1~ &minus; *x&#772;*~2~

The *estimate* of the sampling distribution's *spread* given the **observed data**.

. . .

::: {.definition style="margin-top: 50px; width: 90%;"}
Let:

- $\bar{x}_1$ and $\bar{x}_2$ be the *sample means* of each group,
- $s_1$ and $s_2$ be the *sample standard deviations* of each group,
- and $n_1$ and $n_2$ be the *sample sizes* of each group.

Hence, the standard error of $\bar{x}_1 - \bar{x}_2$ is defined as

$$
\text{se}(\bar{x}_1 - \bar{x}_2) = \sqrt{\frac{(s_1)^2}{n_1} + \frac{(s_2)^2}{n_2}}
$$
:::

. . .

::: {.dummy style="margin-top: 50px;"}
This definition of $\text{se}(\bar{x}_1 - \bar{x}_2)$ *does not* assume that the underlying standard deviations of each group are the same.
:::

::: {.aside}
**Note:** $\bar{x}_1 - \bar{x}_2$ is the *estimate* of the sampling distribution's *centre* given the **observed data**.
:::


## [Ex 6:]{.red} Handedness and Earnings

<blockquote style="border-left: 0.25em solid #685f5f;">
Could handedness be a factor that explains differences in the average hourly earnings? Ruebeck et al. (2007) randomly sampled 2295 American men and numerically summarised the recorded hourly earnings (measured in USD) by handedness below.
</blockquote>

$$
\bar{x}_\text{Left} = \$13.40, \quad s_\text{Left} = \$7.9, \quad n_\text{Left} = 268 \\
\bar{x}_\text{Right} = \$13.10, \quad s_\text{Right} = \$7.9, \quad n_\text{Right} = 2027
$$

::: {.aside}
Ruebeck, C. S., Harrington Jr, J. E., & Moffitt, R. (2007). Handedness and earnings. *Laterality*, **12**(2), 101--120.
:::

## Estimation of the Difference in Means

:::::: {.columns}
::::: {.column}
**Point Estimate**

::: {.definition style="width: 15%; margin-left: 0;"}
$\bar{x}_1 - \bar{x}_2$
:::

:::: {.fragment}
::: {style="margin-top: 50px;"}
**Interval Estimate^[By constructing a *[confidence interval]{.tomato}* for the differnece in the "true" means.]**
:::

::: {.definition-orchid style="width: 58%; margin-left: 0;"}
 $\bar{x}_1 - \bar{x}_2 \pm t^*_p(\nu) \times \text{se}(\bar{x}_1 - \bar{x}_2)$
:::
::::

:::: {.fragment .incremental style="margin-left: 25px;"}
where $t^*_p(\nu)$ is the *t*-multiplier such that:

::: {style="margin-top: -15px;"}
- $p = 1 - \text{Conf. Level}/2$ 
- $\nu = \text{min}(n_1 - 1, n_2 - 1)$ [*by hand*]{.fragment .highlight-blue}^[Statistically inclined software like [Python]{.cornflowerblue} use Satterthwaite's approximation to determine $\nu$.]
:::
::::
:::::
::::: {.fragment .column}
Recall for [**Ex 6:**]{.red}
<blockquote style="border-left: 0.25em solid #685f5f; margin-bottom: 50px;">
$$
\bar{x}_\text{Left} = \$13.40, \quad s_\text{Left} = \$7.9, \quad n_\text{Left} = 268 \\
\bar{x}_\text{Right} = \$13.10, \quad s_\text{Right} = \$7.9, \quad n_\text{Right} = 2027
$$
</blockquote>

```{python noise-multiplier}
#| echo: true
#| classes: fragment

# Load in the stats submodule from the scipy package
from scipy import stats

# Determine the t-multiplier for a 95% C.I.
stats.t.ppf(0.975, 267)
```
:::::
::::::

## Interpretation of the Confidence Interval

[**Ex 6:**]{.red} The 95% C.I. for $\mu_\text{Left} - \mu_\text{Right}$ is $(-0.7711021 , 1.3711021)$

. . .

<ul style="margin-top: 25px;">
  <li style="line-height: 1.1;">A [positive]{.tomato} number means that the true mean of the *first* group was estimated to be **greater than** that of the *second* group.</li>
  <li class="fragment" style="line-height: 1.1;">A [negative]{.steelblue} number means that the true mean of the *first* group was estimated to be **lower than** that of the *second* group.</li>
  <li class="fragment" style="line-height: 1.1;">You can "invert" the signs of the C.I. to interpret it the other way around. Hence, the 95% C.I. for $\mu_\text{Right} - \mu_\text{Left}$ is? [$(-1.3711021, 0.7711021)$]{.printOnly}</li>
</ul>

::: {.printOnly style="margin-top: 50px;"}
With 95% confidence, we estimate that the true mean hourly earnings of left-handed American men were somewhere between \$0.77 per hour lower and \$1.37 per hour higher than that of right-handed American men.
:::

## Test for the Difference in Means

## Using Student's *t*-distribution to Calculate the *p*-value

## Interpretation of the Hypothesis Test

## [Ex 7:]{.red} Jet Noise

::::: {.columns}
:::: {.column width="70%"}
<blockquote style="border-left: 0.25em solid #685f5f;">
The `jet-noise.csv` file describes a study investigated the noise levels of a random sample of wide-bodied jets, and narrow-bodied jets were measured immediately after their wheels left the ground at an international airport. Why noise levels? The researchers thought it may influence the frequency of birds being hit by aircraft (as it is regarded as a safety hazard).
</blockquote>

::: {.fragment fragment-index=1 .orchid-table style="font-size: 0.9em; margin-top: 50px; width: 90%;"}
+:----------+:----------------------------------------------------------------------------------------------------------------------------+
| **noise** | A number that denotes the noise level after the jet "took off", measured in decibels (dB). 
+-----------+-----------------------------------------------------------------------------------------------------------------------------+
| **body**  | A string that denotes the body type of the jet, either `wide` (for wide-bodied) or `narrow` (for narrow-bodied). 
+-----------+-----------------------------------------------------------------------------------------------------------------------------+
:::
::::
:::: {.column width="30%" .fragment fragment-index=0}
```{r alloy} 
#| results: asis
#| classes: excel

noise.df <- read.csv("datasets/jet-noise.csv")
 
rbind(colnames(noise.df), head(noise.df, n = 14), rep("...", ncol(noise.df))) |>
  kable(format = "html", row.names = TRUE, col.names = LETTERS[1:ncol(noise.df)])
```
::::
:::::

::: {.aside}
Data from Wild, C. J., & Seber, G. A. F. (2000). *Chance Encounters: A First Course in Data Analysis and Inference*. Wiley.
:::

## [Ex 7]{.red} Inferential Statistics in [Python]{.cornflowerblue}

::: {style="width: 85%;"}
```{python Ex-7}
#| echo: true

# Load in one submodule from the scipy package and the pandas package
from scipy import stats
import pandas

# Read in the jet-noise.csv file
noise_df = pandas.read_csv("datasets/jet-noise.csv")

# Group the data by body
noise_grouped = noise_df.groupby(["body"])

# Calculate the inferential statistics
noise_ttest = stats.ttest_ind(
  a = noise_grouped.get_group("wide")["noise"], 
  b = noise_grouped.get_group("narrow")["noise"], 
  equal_var = False, alternative = "two-sided"
)

# Print the constructed 95% confidence interval
noise_ttest.confidence_interval(confidence_level = 0.95)

# Print the result of the hypothesis test, whose alternative hypothesis was specified above
noise_ttest
```
:::

::: {.aside}
**Documentation**: [docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html#scipy.stats.ttest_ind](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html#scipy.stats.ttest_ind)
:::

## Assumptions for Inference on the Difference in Means

::: {.incremental}
1. **Independent** observations between *and* within groups
2. *Within* [group]{style="color: steelblue;"}: One measure of centre can satisfactorily summarise the group
3. *Within* [group]{style="color: steelblue;"}: Approximately symmetrical about the group's **sample mean**, $\bar{x}_i$, and there are no outliers
:::

## Practice Exercises {visibility="uncounted"}

<!-- https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_1samp.html#scipy.stats.ttest_1samp -->


<!--  company producing batteries wishes to test if there is any difference between the -->
<!-- life of two recently developed battery prototypes (battery A and battery B). -->
<!-- A sample of 15 battery A, and 12 battery Bâ€™s were tested. The sample statistics are -->
<!-- shown in the table below: -->
<!-- Perform a two-sample t-test to test whether a mean difference exists between the -->
<!-- two batteries, at a significance level of 5% -->
<!-- Battery Sample mean Sample Stdev Sample Size -->
<!-- A 145 18 15 -->
<!-- B 162 12 12 -->
